<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>凝萌小记</title>
    <description>作家是杂家</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Fri, 27 Oct 2017 09:17:09 +0800</pubDate>
    <lastBuildDate>Fri, 27 Oct 2017 09:17:09 +0800</lastBuildDate>
    <generator>Jekyll v3.6.2</generator>
    
      <item>
        <title>一些收获</title>
        <description>&lt;h2 id=&quot;从p值开始&quot;&gt;从p值开始&lt;/h2&gt;

&lt;p&gt;对于空间自相关，之前一直没看明白，只是大概知其所以，但也就这样不知其所以然。&lt;/p&gt;

&lt;p&gt;其中原因，也许是统计没学好。但这不能怪我，毕竟我们概率统计都没讲到假设检验。&lt;/p&gt;

&lt;p&gt;今天上课讲地理统计，提到空间自相关，老师解释了一通p值，但似乎没戳到p值本质，于是我在网上找了一下，很糙地理解了何为p值。&lt;/p&gt;

&lt;h2 id=&quot;假设-检验&quot;&gt;假设-检验&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://www.360doc.com/content/15/0704/22/22175932_482657194.shtml&quot;&gt;你真的懂p值吗? - 说人话的统计学&lt;/a&gt;里面把p值讲得十分通俗易懂，是一篇难得的好文章。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;原文对p值定义是：“在假定原假设为真时，得到与样本相同或者更极端的结果的概率。”
这和Wikipedia中引的定义差不多。
the probability for a given statistical model that, when the null hypothesis is true, the statistical summary (such as the sample mean difference between two compared groups) would be the same as or of greater magnitude than the actual observed results.
refer - Wasserstein, Ronald L.; Lazar, Nicole A. (7 March 2016). “The ASA’s Statement on p-Values: Context, Process, and Purpose”. The American Statistician. 70 (2): 129–133. doi:10.1080/00031305.2016.1154108. Retrieved 30 October 2016.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;文中，还举了一个很好的例子：&lt;/p&gt;

&lt;p&gt;statistical model：AB两人掷硬币，硬币由A提供。&lt;/p&gt;

&lt;p&gt;null hypothesis：B首先假设硬币是均质的。&lt;/p&gt;

&lt;p&gt;observed results：B检查硬币，掷五次，出现五次正面。&lt;/p&gt;

&lt;p&gt;在这个例子中p值：p=Pr(A)+Pr(B),
其中:
A=the same asthe actual observed results（出现五次正面）,
B=greater magnitude than the actual observed results（更小概率的情况）.&lt;/p&gt;

&lt;p&gt;显然p值很小的时候我们的零假设就可以被拒绝了。&lt;/p&gt;

&lt;h2 id=&quot;空间自相关&quot;&gt;空间自相关&lt;/h2&gt;

&lt;p&gt;空间自相关的零假设是“空间分布是均匀的”，然后在这个条件下算出当前分布出现的概率和跟不均匀的概率的和，这个结果就是p值。&lt;/p&gt;

&lt;p&gt;至于p值小于多少（显著性水平α），就是人为指定的了。&lt;/p&gt;

&lt;p&gt;因此空间自相关的p值说明的是“在显著性水平α下没有发现足够的证据反对原假设”。&lt;/p&gt;

&lt;p&gt;知乎上还提到，p值其实是拒绝真的概率，也就是说，如果我们拒绝假设，有p的概率是该假设为真。从而又引申出第一类错误、第二类错误的概念。&lt;/p&gt;

&lt;h2 id=&quot;关于统计学&quot;&gt;关于统计学&lt;/h2&gt;

&lt;p&gt;统计是一个很有趣而且实用的东西，在地理学的研究中其实十分重要，或者说，有时候我们对一些概念的不理解其实是因为统计没学好。&lt;/p&gt;

&lt;p&gt;2017.10.23 晚 于广州&lt;/p&gt;
</description>
        <pubDate>Mon, 23 Oct 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/10/23/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/10/23/post01/</guid>
        
        <category>统计</category>
        
        <category>空间分析</category>
        
        
      </item>
    
      <item>
        <title>我想写一篇文章</title>
        <description>&lt;h2 id=&quot;关于苦闷&quot;&gt;关于苦闷&lt;/h2&gt;

&lt;p&gt;我想写一篇文章来表达我内心的苦闷，但是我连我内心的情感都无法好好地说出来，那就像是一个未懂言语的孩子咿咿呀呀地哭着叫着，让别人看着好笑。&lt;/p&gt;

&lt;p&gt;说一个故事容易，写成一篇文章却颇难。&lt;/p&gt;

&lt;p&gt;六年前的我，还是一个喜欢文艺却不愿读书的青年，那时正是爱好谈情的年纪–总歆羡着怎样风花之前，憧憬着如何雪月之下。以为这世间惟有妹子与爱不可辜负。现今看来似乎也并不如此，只不过那时用来把自己灌醉的梅子酒瓶，还散发出淡淡的青涩的馨香。&lt;/p&gt;

&lt;p&gt;那时的笑靥与心跳，我大概是早已忘记了。我只记得那个映着彩霞的傍晚，我逃离了教室，逃离了宿舍，逃离了饭堂，逃去了一个见不着人只见得着天空的地方，在那里即便我不用双手捂着脸也不会感到羞耻。我对着抹着浓浓胭脂的天空说了好多情话，即便他倦了也不肯停下来。后来，他亮起了点点星灯一直为我倾听。我也一直对着它倾诉，直到今天仍未回来。&lt;/p&gt;

&lt;p&gt;再往前的三年，也是有那么一个晚上，月光躲在淡淡的云里，只羞涩地透出微微光晕。而我也同样地掩着自己的心扉。那时也还能面不改色地背诵“身无彩凤双飞翼，心有灵犀一点通”。尔今细思，我与那女子或是那女子约莫凿实是心有灵犀的，也许就少了那么一点。再后来，就再无能够“一点通”的事物了，若是非要说有，那便是某本作业用的练习册了。&lt;/p&gt;

&lt;p&gt;人们常说，“酒逢知己千杯少”，但于我而言，千杯怕是喝不下的，但知己倒是逢着了几位。&lt;/p&gt;

&lt;p&gt;年青人好议论，如今的我也如此，只是到现在，再没有能找到几个能称知己的–曾经的知己，不是忙碌了，便是四散了。现在要是有话要说，也只能倒两壶小酒，自己说自己听罢了。&lt;/p&gt;

&lt;p&gt;今年入五月后不久，某君误会我意，但这一记歪打却正着我本心，然其后无果，只得出个“话不投机半句多”的结论。自那起，我便开始谋划着，总有一天要抱一只小猫过活。自诩为“生活家”的我，计划着要独享世间一切美好的事物，诸如诗，画，故事，音乐，远方，当然还有静谧的午后和慵懒的阳光–这或许是可以和小猫同享的。&lt;/p&gt;

&lt;p&gt;谁也愿意虚度时光，谁又愿意浪费时光？我以为世上的好与坏，都是值得去经验的，我们谈美，谈快乐，同我们谈丑，谈悲伤同义。须知闪光的钻石与乌黑的煤泥乃是同素的。&lt;/p&gt;

&lt;p&gt;佛曰七苦：生，老，病，死，爱别离，怨憎会，求不得。期间种种悲苦，其实都是值得庆祝的事情。&lt;/p&gt;

&lt;p&gt;生是幸运的，但以生为苦，皆因一切苦的根源都是生。每日我睁开眼由梦中醒来，感到的是对新一日的期待，同时也伴随着对现实对生的疲倦。反过来，死，作为生的对立面是可怕的，但又因向死而有生，若无死则无所谓生。&lt;/p&gt;

&lt;p&gt;至于老、病，会带来悲苦，其中又渗着年轻的活力与生命的希望。我们贪恋青春的容颜与美好的肉体，但又渴望长进与经验，这便是老、病的矛盾。&lt;/p&gt;

&lt;p&gt;如果说“生，老，病，死”是人对时间的流逝和生命的脆弱而感到的无助之苦，那么“爱别离，怨憎会，求不得”便是对命运无常的无奈之苦。人生中最壮美的故事，不过此三。&lt;/p&gt;

&lt;p&gt;所爱者终究是要别离的，令人憎恶的事物总是会遇上的，至于人生之不如意者，十常八九。如此看来，我等人生，岂不图有苦闷？是的吧，人生之苦闷久矣，若不，佛家何以称死后登极乐，基督何以称得道入天堂？&lt;/p&gt;

&lt;p&gt;我要写一篇文章来表达我内心的苦闷，但一提起笔来，写的都是些值得庆祝的事情。&lt;/p&gt;

&lt;p&gt;2017.10.05 凌晨 于佛山&lt;/p&gt;
</description>
        <pubDate>Thu, 05 Oct 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/10/05/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/10/05/post01/</guid>
        
        <category>生活</category>
        
        <category>文艺</category>
        
        
      </item>
    
      <item>
        <title>爬虫入门笔记（二）</title>
        <description>&lt;h2 id=&quot;缘起&quot;&gt;缘起&lt;/h2&gt;

&lt;p&gt;昨晚回宿舍的时候，看到一对情侣在路边撒狗粮，就像这样：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic01.jpeg&quot; alt=&quot;图 - 1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;然后我就想可不可以上微博看看有没有相亲的，嗯，好像还真有：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic02.png&quot; alt=&quot;图 - 2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;那不如用爬虫爬一份相亲列表出来吧，嘿嘿嘿。&lt;/p&gt;

&lt;p&gt;我们尝试用&lt;a href=&quot;http://blog.rimoe.ml/2017/08/24/post01/&quot;&gt;上一篇文章&lt;/a&gt;的方法获取&lt;a href=&quot;http://weibo.com/u/3803639941?refer_flag=1001030001_&amp;amp;nick=%E4%BA%8C%E6%AC%A1%E5%85%83%E4%BA%A4%E5%BE%80%E5%B9%B3%E5%8F%B0&amp;amp;is_hot=1&amp;amp;noscale_head=1#_0&quot;&gt;二次元交往平台&lt;/a&gt;的主页。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;urllib2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;urlopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://weibo.com/u/3803639941?refer_flag=1001030001_&amp;amp;&quot;&lt;/span&gt;
                       &lt;span class=&quot;s&quot;&gt;&quot;nick=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E4&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;BA&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%8&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E6&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;AC&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;A1&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%85%83%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E4&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;BA&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;A4&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;BE&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%80%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E5&quot;&lt;/span&gt;
                       &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;B9&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;B3&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%8&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;B0&amp;amp;is_hot=1&amp;amp;noscale_head=1#_0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'gbk'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 以gbk方式解码&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然而发现……没有妹纸呀……&lt;/p&gt;

&lt;p&gt;仔细观察，发现打印出来的开头是这样的：&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;http-equiv=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Content-type&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text/html; charset=gb2312&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Sina Visitor System&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;访客系统……也就是说跳转到登录的网页了，需要登录才可以访问。&lt;/p&gt;

&lt;p&gt;对于这种情况，我们可以有两个办法：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;让爬虫自己登录&lt;/li&gt;
  &lt;li&gt;手工登录，然后爬虫使用cookie&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;在这篇文章里，我们手工登录获取cookie，然后使用cookie访问网页，至于第一种方法，后续的文章再做讨论。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;运行环境&quot;&gt;运行环境&lt;/h2&gt;

&lt;p&gt;之前也说过了，这里语句运行环境都为Mac OS／Python2.7.13。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;获取cookie&quot;&gt;获取cookie&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;维基百科:Cookie，中文名称为“小型文本文件”或“小甜饼”，指某些网站为了辨别用户身份而储存在用户本地终端上的数据（通常经过加密）。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;平时我们PC上用微博时，在一次登录后，我们后续访问就可以不用登录了，其实就是本地存储了登录状态，请求网页时发送本地的cookie即可表明账户登录状态。&lt;/p&gt;

&lt;p&gt;利用Chrome的开发者工具可以很方便地获取cookie。&lt;/p&gt;

&lt;p&gt;如图，在Network中查看提交的Header，我们可以看到长长的一串字符，在访问网页时，我们只要提交这个cookie，就可以使用登录状态访问网页啦。&lt;/p&gt;

&lt;p&gt;这个cookie在登录后持续有效直到退出账户或该次登录失效。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;配置请求头&quot;&gt;配置请求头&lt;/h2&gt;

&lt;p&gt;之前写&lt;a href=&quot;http://blog.rimoe.ml/2017/07/29/post01/&quot;&gt;API调研究&lt;/a&gt;的时候也提到了HTML请求方式和Header。&lt;/p&gt;

&lt;p&gt;具体可以查阅&lt;a href=&quot;http://www.runoob.com/http/http-tutorial.html&quot;&gt;HTTP教程&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;我们在这里尝试使用urllib2提交请求头。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;urllib2&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://weibo.com/u/3803639941?refer_flag=1001030001_&amp;amp;&quot;&lt;/span&gt;
       &lt;span class=&quot;s&quot;&gt;&quot;nick=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E4&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;BA&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%8&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E6&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;AC&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;A1&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%85%83%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E4&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;BA&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;A4&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;BE&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%80%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E5&quot;&lt;/span&gt;
       &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;B9&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;B3&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;E5&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%8&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;B0&amp;amp;is_hot=1&amp;amp;noscale_head=1#_0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cookie&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'SINAGLOBAL=balabala'&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 输入cookie&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'cookie'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cookie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 将URL、Header打包请求，当然这里还可以有别的参数&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# class urllib2.Request(url[, data][, headers][, origin_req_host]\&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# [, unverifiable])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;urlopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 提交请求并获取响应&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;返回：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic03.png&quot; alt=&quot;图 - 3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;好啦，接下来就是正则表达式的事情了。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;使用beautifulsoup提取信息&quot;&gt;使用BeautifulSoup提取信息&lt;/h2&gt;

&lt;p&gt;可是，正则表达式用起来十分不方便，还容易出错，一不小心格式就调不好，还有可能连错在哪都搞不清楚。&lt;/p&gt;

&lt;p&gt;我们知道在HTML DOM中HTML的所有内容被都视为一种节点，其实我们只要知道节点的路径，就可以快速获取该节点提取相应信息。BeautifulSoup就可以基于这个原理用于快速获取html里的信息。&lt;/p&gt;

&lt;p&gt;这里就可以尝试使用BeautifulSoup来代替正则表达式，体会一下鸟枪换炮的感觉。&lt;/p&gt;

&lt;p&gt;据说bs4对Python3并不友好，但我们用的是python2就不管那么多了。&lt;/p&gt;

&lt;p&gt;当然使用前我们要先安装一下bs4这个库,另外我们还需要lxml这个库的支持（用于解析html，类似的还有html5lib以及python自带的html.parser）:&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip install bs4
pip install lxml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;观察源码，我们可以发现，微博的网页其实是使用一个js函数FM.view(json)来展示的，html存在一个json格式中：&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;FM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;ns&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;domid&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;xxx&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;css&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;...&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;html&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;balabala&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic04.png&quot; alt=&quot;图 - 4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;再仔细观察，可以发现，主页微博的html是在domid为Pl_Official_MyProfileFeed__22的json中的，我们先用正则表达式把这部分内容提取出来。使用json模块解析其中的html属性，就得到用户主页微博的html文本。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#承接上一节response为返回内容&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;json&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pattern&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;r'&quot;domid&quot;:&quot;Pl_Official_MyProfileFeed__22&quot;,(.*?)\)&amp;lt;/script&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;webres&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#用正则表达式提取包含内容部分&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;webres_json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'{'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;webres&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#解析json字符串，前面要补充`{`字符&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;webres_html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;webres_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'html'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;打印出来是这样的：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic05.png&quot; alt=&quot;图 - 5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;接下来我们用BeautifulSoup对html文本进行分析，首先看看造出来soup是怎样的呢？&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#使用BeautifulSoup对webres_html进行分析&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;lxml&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;bs4&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BeautifulSoup&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;soup&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;webres_html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'lxml'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 构建Soup&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;soup&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic06.png&quot; alt=&quot;图 - 6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;打印出来的东西十分整齐，真是一个beautiful的soup，看着就很舒服。使用contents可以逐级分析html下的标签元素。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;soup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contents&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;soup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contents&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;通过源码我们大概知道，在每条单独微博都在一个class为”WB_dertail”的div里，使用find_all的方法，得到所有符合条件的标签，以数组形式返回，然后我们，将微博里的含信息标签全部提取出来。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 微博每张图片有id，缩略图URL、URL分别为以下格式：&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# http://wx4.sinaimg.cn/mw690/(pic_id).jpg   # URL&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# http://wx4.sinaimg.cn/square/(pic_id).jpg  # 缩略图URL&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;infos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;soup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;class_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WB_detail&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pattern_pic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;r'pic_id=(.*)'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;infos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Stxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;txts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;class_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WB_text W_f14&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contents&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pics&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'li'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txtc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;Stxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;txtc&lt;/span&gt;              &lt;span class=&quot;c&quot;&gt;# 对于链接文本，提取其内容&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;Stxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt;               &lt;span class=&quot;c&quot;&gt;# 否则原样输出&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pic&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;                &lt;span class=&quot;c&quot;&gt;# 得到图片URL&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;picid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern_pic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pic&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'action-data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;http://wx1.sinaimg.cn/mw690/&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;picid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'.jpg'&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stxt&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;打印出来的效果：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic07.png&quot; alt=&quot;图 - 7&quot; /&gt;&lt;/p&gt;

&lt;p&gt;关于BeautifulSoup的用法，可以参考&lt;a href=&quot;http://cuiqingcai.com/1319.html&quot;&gt;静觅 - Python爬虫利器二之Beautiful Soup的用法&lt;/a&gt;，此外个人觉得XPath更好用，具体可以参考&lt;a href=&quot;http://cuiqingcai.com/2621.html&quot;&gt;Python爬虫利器三之Xpath语法与lxml库的用法&lt;/a&gt;。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;写文件&quot;&gt;写文件&lt;/h2&gt;

&lt;p&gt;写文件当然容易，但要保存图片的话，就需要用到imghdr模块。&lt;/p&gt;

&lt;p&gt;imghdir的what模块可以返回图片的文件格式。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;imghdr&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;what&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;urllib2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pic_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'http://rimoe.ml/assets/img/9030.jpg'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;save_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'/Users/_nA/Desktop/'&lt;/span&gt;    &lt;span class=&quot;c&quot;&gt;# 存储路径&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;photo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;urlopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pic_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pic_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;what&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;photo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;        &lt;span class=&quot;c&quot;&gt;# 判断图片格式&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pic_type&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;                   &lt;span class=&quot;c&quot;&gt;# 若无法识别格式返回None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pic_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;save_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'pic.'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pic_type&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'w'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;photo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;按页数依次爬取&quot;&gt;按页数依次爬取&lt;/h2&gt;

&lt;p&gt;这样下来我们只能抓取一部分，妹子根本不够看，那我们就多抓几页：&lt;/p&gt;

&lt;p&gt;我们可以看到微博主页的URL可以设置URL参数，这里简单地修改URL的page参数即可。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://weibo.com/u/3803639941?is_search=0&amp;amp;visible=0&amp;amp;is_all=1&amp;amp;is_tag=0&amp;amp;&quot;&lt;/span&gt;
       &lt;span class=&quot;s&quot;&gt;&quot;profile_ftype=1&amp;amp;page=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;最后程序可以写成函数，写个循环就开始跑了。&lt;/p&gt;

&lt;p&gt;跑出来结果如下：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic08.png&quot; alt=&quot;图 - 8&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic09.png&quot; alt=&quot;图 - 9&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;结尾&quot;&gt;结尾&lt;/h2&gt;

&lt;p&gt;嗯，可是这东西爬下来关我什么事呢？&lt;/p&gt;

&lt;p&gt;写这篇文章的人真是有够无聊了，还不如去看二次元的妹子（误）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017090401/pic10.jpg&quot; alt=&quot;图 - 10&quot; /&gt;&lt;/p&gt;

&lt;p&gt;代码已发到&lt;a href=&quot;https://github.com/codeRimoe/Spider/tree/master/demo/Level_2&quot;&gt;Github - Spider&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;2017.09 于广州&lt;/p&gt;
</description>
        <pubDate>Mon, 04 Sep 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/09/04/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/09/04/post01/</guid>
        
        <category>爬虫</category>
        
        <category>技术</category>
        
        <category>Python</category>
        
        <category>数据获取</category>
        
        
      </item>
    
      <item>
        <title>爬虫入门笔记（一）</title>
        <description>&lt;h2 id=&quot;缘起&quot;&gt;缘起&lt;/h2&gt;

&lt;p&gt;三月份的时候，那时的我还很有志气地打算学习数据分析的，然而后来发现自己似乎把技能点点到前端上了。&lt;/p&gt;

&lt;p&gt;数据分析的话要有数据呀，嗯，从网上获取数据吧。手动扒太累了，就写个小程序咯。&lt;/p&gt;

&lt;p&gt;说起来接触Python还是因为认识的同学说想学爬虫，然后问我写爬虫用什么语言好。我百度了一下，似乎写爬虫都用Python，于是我就跟他讲，你学Python吧。后来又由于各种原因我也进了Python的坑。&lt;/p&gt;

&lt;p&gt;那到底什么是爬虫呢？说白了就是自动浏览网页获取网页的自动化程序，其实我们常用搜索引擎就有爬虫技术，比如Google爬虫。至于为什么用Python写，刚刚就说了，大家都用这个写，学的话也容易上手。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017082401/pic01.jpg&quot; alt=&quot;图 - 1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;我们平时访问网页，表面上就是输入网址-浏览网页-获取信息三步，因此最简单的爬虫就是不断重复这三步。&lt;/p&gt;

&lt;p&gt;事实上，写爬虫这东西，其实并没有太多技术性。但想造出健壮的爬虫，其实并不容易的。爬虫与反爬虫的斗争，大家可以上知乎了解一下：&lt;a href=&quot;https://www.zhihu.com/question/58342241&quot;&gt;知乎 - 有哪些有趣的反爬虫手段？&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;至于爬虫能干啥，请看：&lt;a href=&quot;https://www.zhihu.com/question/27621722&quot;&gt;利用爬虫技术能做到哪些很酷很有趣很有用的事情？&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;所需模块&quot;&gt;所需模块&lt;/h2&gt;

&lt;p&gt;写一个最简单的爬虫，其实只需要这两个模块：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;urllib和urllib2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;一看这个模块名就知道是URL相关的library。具体用法可以参看：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.python.org/3/library/urllib.html&quot;&gt;urllib官方文档&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.python.org/2/library/urllib2.html&quot;&gt;urllib2官方文档&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://cuiqingcai.com/947.html&quot;&gt;静觅 - Python爬虫入门三之Urllib库的基本使用&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://cuiqingcai.com/954.html&quot;&gt;静觅 - Python爬虫入门四之Urllib库的高级用法&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;以下语句运行环境为Mac OS／Python2.7.13。&lt;/p&gt;

&lt;p&gt;一开始就说了我们只需要模拟三个步骤：输入网址-浏览网页-获取信息。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;输入网址&quot;&gt;输入网址&lt;/h2&gt;

&lt;p&gt;输入网址是为了获取网页，当然前提是要联网，我们可以先在交互式解释器中看看。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;urllib2&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;urlopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://rimoe.ml&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 打开网页http://rimoe.ml&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;                          &lt;span class=&quot;c&quot;&gt;# 解析re，输出html格式&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;输出：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1 &lt;span class=&quot;nt&quot;&gt;&amp;lt;addinfourl&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;4436195304&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;whose&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;fp =&lt;/span&gt;&lt;span class=&quot;err&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;lt;socket._fileobject&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;at&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;0x10816f8d0&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&amp;gt;
2 '&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;lang=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;en&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;\n  &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;\n  &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; 
  &lt;span class=&quot;na&quot;&gt;http-equiv=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-UA-Compatible&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;IE=edge&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;\n …… &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;\n'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017082401/pic02.jpg&quot; alt=&quot;图 - 2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;事实上，获取数据就是这么两句话。在某种意义上来说，网页经已爬下来了，爬虫已经写完啦。&lt;/p&gt;

&lt;p&gt;先压抑内心的小兴奋，爬下来这么一堆东西有啥用呢？&lt;/p&gt;

&lt;p&gt;当然，这样一堆字符看起来没啥用，但我们可以想办法从中间提取想要的元素。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;浏览网页&quot;&gt;浏览网页&lt;/h2&gt;

&lt;p&gt;我们日常浏览的网页一般都是浏览器解析过的标签文件，具体过程可以参考：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/xiangriikui/article/details/52207153&quot;&gt;前端文摘：深入解析浏览器的幕后工作原理&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/lhb25/p/how-browsers-work.html&quot;&gt;在浏览器中输入网址到网页展现全部过程&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;当然对于爬虫而言，我们希望程序输出的只包含我们需要的信息，因此我们需要对刚刚抓取的网页进行分析，也就是写程序来代替浏览器解释我们获取的文件（这里是html）。&lt;/p&gt;

&lt;p&gt;这里就可以用到「正则表达式」这个东西了。&lt;/p&gt;

&lt;p&gt;正则表达式，故名思义，就是规则的表达式，或者说是一个样例，通过这个样例我们可以从文本中规范准确地提取符合该样例的部分文本。&lt;/p&gt;

&lt;p&gt;我们可以用正则表达式来提取能够匹配表达式的文本，正则表达式的匹配规则如下：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017082401/pic03.png&quot; alt=&quot;图 - 3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;部分注解抄录如下：&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;（1）数量词的贪婪模式与非贪婪模式&lt;/p&gt;

  &lt;p&gt;正则表达式通常用于在文本中查找匹配的字符串。Python里数量词默认是贪婪的（在少数语言里也可能是默认非贪婪），总是尝试匹配尽可能多的字符；非贪婪的则相反，总是尝试匹配尽可能少的字符。例如：正则表达式”ab&lt;em&gt;”如果用于查找”abbbc”，将找到”abbb”。而如果使用非贪婪的数量词”ab&lt;/em&gt;?”，将找到”a”。&lt;/p&gt;

  &lt;p&gt;注：我们一般使用非贪婪模式来提取。&lt;/p&gt;

  &lt;p&gt;（2）反斜杠问题&lt;/p&gt;

  &lt;p&gt;与大多数编程语言相同，正则表达式里使用”\”作为转义字符，这就可能造成反斜杠困扰。假如你需要匹配文本中的字符”\”，那么使用编程语言表示的正则表达式里将需要4个反斜杠”\\”：前两个和后两个分别用于在编程语言里转义成反斜杠，转换成两个反斜杠后再在正则表达式里转义成一个反斜杠。&lt;/p&gt;

  &lt;p&gt;Python里的原生字符串很好地解决了这个问题，这个例子中的正则表达式可以使用r”\”表示。同样，匹配一个数字的”\d”可以写成r”\d”。有了原生字符串，妈妈也不用担心是不是漏写了反斜杠，写出来的表达式也更直观勒。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;图片引用及参考来自：&lt;a href=&quot;http://cuiqingcai.com/977.html&quot;&gt;静觅 - Python爬虫入门七之正则表达式&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Python的re模块可以使用正则表达式匹配字符串：&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;### 举例1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;txt1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'rimoe,rimoe.ml'&lt;/span&gt;          &lt;span class=&quot;c&quot;&gt;#从txt1中搜索关键字'rimoe'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pattern1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'rimoe'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;#用正则表达式生成pattern对象&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;        &lt;span class=&quot;c&quot;&gt;#查找所有符合表达式的子串&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;### 举例2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;txt2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'1.rimoe&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;2.Yue&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;3.Luo&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;       &lt;span class=&quot;c&quot;&gt;# 从txt2中提取列表内容&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pattern2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;r'\d+\.(.*?)\n'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 一般用r串作为参数&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 这里\d匹配数字（0～9），+表示匹配连续的数字，\.匹配字符'.'&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (.*?)匹配连续任意字符任意次，括号表示要提取的部分分组&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# \n匹配回车，(.*?)\n表示任意字符匹配直到遇到回车停止匹配&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;输出&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'rimoe'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'rimoe'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'rimoe'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Yue'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Luo'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;比如对于我们刚刚爬下来的网页，我们想要提取网页的这一部分：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017082401/pic04.jpg&quot; alt=&quot;图 - 4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;我们可以右击相应元素，点“检查”（审查元素）查看相对应的标签：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017082401/pic05.jpg&quot; alt=&quot;图 - 5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;当然这里推荐Chrome，主要是因为好用加功能完善，在学习爬虫的道路上这个审查元素的功能和这个开发者选项框将会是你学习爬虫的好基友，弹出的框如下图：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017082401/pic06.jpg&quot; alt=&quot;图 - 6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;我们可以看到其实这一部分是一个列表标签，在我们刚刚抓取的网页里面也能找到：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017082401/pic07.jpg&quot; alt=&quot;图 - 7&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;ul&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;li&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://github.com/codeRimoe/h5_game_kanna&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;h5 Game - 坎娜与托尔&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;  
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://blog.rimoe.ml/2017/06/09/post01/&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;[NOTE BLOG]&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://rimoe.ml/kanna&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;[TRY NOW]&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;li&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://github.com/codeRimoe/Wolf_and_Sheep&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;OOP Homework - Wolf and Sheep&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\\&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;[NOTE BLOG]&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ul&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;我们用正则表达式来表示,分两次提取：&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 刚刚提取的网页返回res&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;txt1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pattern1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;r'&amp;lt;li&amp;gt;(.*?)&amp;lt;/li&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 提取列表标签&amp;lt;li&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# re.S为DOCALL模式，该模式下字符'.'可以匹配回车'\n'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;txt2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt2&lt;/span&gt;                               &lt;span class=&quot;c&quot;&gt;# 打印出来看看是什么样子的吧～&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pattern2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;r'&amp;lt;a.*?href=(.*?)&amp;gt;(.*?)&amp;lt;/a&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;# 逐项提取链接标签&amp;lt;a&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Project：'&lt;/span&gt;                    &lt;span class=&quot;c&quot;&gt;# 格式化打印&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;':'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;输出：&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;          &amp;lt;a href=&quot;https://github.com/codeRimoe/h5_game_kanna&quot;&amp;gt;h5 Game - &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\xe5\x9d\x8e\xe5\xa8\x9c\xe4\xb8\x8e\xe6\x89\x98\xe5\xb0\x94&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;lt;/a&amp;gt;  &amp;lt;a href=&quot;http://blog.rimoe.ml/2017/06/09/post01/&quot;&amp;gt;[NOTE BLOG]&amp;lt;/a&amp;gt;  &amp;lt;a href=&quot;http://rimoe.ml/kanna&quot;&amp;gt;[TRY NOW]&amp;lt;/a&amp;gt;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;        '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;          &amp;lt;a href=&quot;https://github.com/codeRimoe/Wolf_and_Sheep&quot;&amp;gt;OOP Homework - Wolf and Sheep&amp;lt;/a&amp;gt;  &amp;lt;a href=&quot;http://blog.rimoe.ml/2017/07/27/post01/&quot;&amp;gt;[NOTE BLOG]&amp;lt;/a&amp;gt;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;        '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Project&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h5&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Game&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;坎娜与托尔&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://github.com/codeRimoe/h5_game_kanna&quot;&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NOTE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLOG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://blog.rimoe.ml/2017/06/09/post01/&quot;&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TRY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NOW&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://rimoe.ml/kanna&quot;&lt;/span&gt;

&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Project&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;：&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;OOP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Homework&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Wolf&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sheep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;https://github.com/codeRimoe/Wolf_and_Sheep&quot;&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NOTE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BLOG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://blog.rimoe.ml/2017/07/27/post01/&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017082401/pic08.jpg&quot; alt=&quot;图 - 8&quot; /&gt;
&lt;img src=&quot;/img/in-post/2017082401/pic09.jpg&quot; alt=&quot;图 - 9&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;获取信息&quot;&gt;获取信息&lt;/h2&gt;

&lt;p&gt;一般来说数据获取后，要保存到本地，对于列表一般保存为csv格式，这里我们就保存为普通的文本文件。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#将打印部分修改成保存文档&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'data.txt'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'w'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Project:'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;':'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017082401/pic10.jpg&quot; alt=&quot;图 - 10&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;总结&quot;&gt;总结&lt;/h2&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Spider Lv1&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;urllib2&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;urlopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://rimoe.ml&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;        &lt;span class=&quot;c&quot;&gt;# 打开网页http://rimoe.ml&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;txt1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pattern1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;r'&amp;lt;li&amp;gt;(.*?)&amp;lt;/li&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 提取列表标签&amp;lt;li&amp;gt;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;txt2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pattern2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;r'&amp;lt;a.*?href=(.*?)&amp;gt;(.*?)&amp;lt;/a&amp;gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'data.txt'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'w'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;findall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pattern2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;txt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;     &lt;span class=&quot;c&quot;&gt;# 逐项提取链接标签&amp;lt;a&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Project:'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;                  &lt;span class=&quot;c&quot;&gt;# 格式化输出&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;':'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;代码已发到&lt;a href=&quot;https://github.com/codeRimoe/Spider/tree/master/demo/Level_1&quot;&gt;Github - Spider&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;爬虫的原理简单粗暴，除了这个简单的爬虫之外，其实还有一些简单易用的现成框架，有硬件条件的话，爬虫的威力其实更大。&lt;/p&gt;

&lt;p&gt;当然有条件的话，最好的爬虫其实是人肉爬虫（滑稽）。&lt;/p&gt;

&lt;p&gt;接下来如果有时间，会继续写完这个爬虫入门笔记系列。&lt;/p&gt;

&lt;p&gt;2017.08.24 午后 于广州&lt;/p&gt;
</description>
        <pubDate>Thu, 24 Aug 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/08/24/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/24/post01/</guid>
        
        <category>爬虫</category>
        
        <category>技术</category>
        
        <category>Python</category>
        
        <category>数据获取</category>
        
        
      </item>
    
      <item>
        <title>对学习及未来的一点思考</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;切莫浮沙筑高台，不为繁华易素心。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;弁言&quot;&gt;弁言&lt;/h2&gt;

&lt;p&gt;近日作息挺规律的，在学校里也算是有事可做。暑假一不小心就被弄丢了，似乎做了些什么，又似乎什么也没做。&lt;/p&gt;

&lt;p&gt;有位老师上课说，大学生活也就是 —— 大一搞社团，大二搞妹子，大三才想起要学习，等到大四就准备去实习。&lt;/p&gt;

&lt;p&gt;我一直以为在学习上我是没有停歇过的，上课认真听 —— 然而也还是将许多节课睡过去了，作业认真写 —— 然而还是有许多作业是糊弄过去的。要说学到最多东西的，大概就是看知乎吧。这天下决心学这些，再过几天就把心思放在别的地方。似乎什么都懂一点，但最后却是什么都没得到。&lt;/p&gt;

&lt;p&gt;我以前可有好好真正地「学习」过？&lt;/p&gt;

&lt;p&gt;有的。小学时候为的一道数学题可以沉思好久，初中时候为了学英文每天努力地记单词，高中时候忘我地写作、刻章，为了整理好一页笔记放弃一个晚修，近来研究爬虫和网页时候遇到问题来回踱步。直到今天认真思考怎么画画才回想起那些时候的感觉。所谓学习，原来是专心思考一件事，可以不被一切的一切所吸引。&lt;/p&gt;

&lt;p&gt;一直以来最惹我羡慕两种人，一种是认真的人，一种是固执的人。&lt;/p&gt;

&lt;p&gt;现在看来，和我交心的几个朋友，要不就是认真的人，要不就是固执的人，要不就是既认真又固执的人。&lt;/p&gt;

&lt;p&gt;近来在知乎上看到一句话，我很喜欢，概括起来就是，「认真」、「固执」。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;切莫浮沙筑高台&quot;&gt;切莫浮沙筑高台&lt;/h2&gt;

&lt;p&gt;这句话出处未考，但似乎很多学工科的都很喜欢这句话。&lt;/p&gt;

&lt;p&gt;基础的不认真学好，是造不出好的东西的。我小时候也试过，物理还没学好，就想去看量子力学，然后结果可想而知。&lt;/p&gt;

&lt;p&gt;记得教我概率统计的王向阳老师上课说，数学系的学生对定义是很清晰的，所以数学系的学生做起题来比理工科的学生好。一直以来，作为理科生，我对问题的思考，都是建立在最基础的概念和定义上的，一句话读不懂，就会一个个词语去想，这个是什么。在学术上，定义是不应该也不可能会被糊弄过去的。&lt;/p&gt;

&lt;p&gt;其实最终说明的道理还是一样，浮沙筑不起高台，这也是我为什么对一些简单的学习和作业也认真记录的原因。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;不为繁华易素心&quot;&gt;不为繁华易素心&lt;/h2&gt;

&lt;p&gt;出自元代冯子振的《西湖梅》：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;苏老堤边玉一林，六桥风月是知音。 任他桃李争欢赏，不为繁华易素心。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;本意说的是淡泊名利，志向高洁。&lt;/p&gt;

&lt;p&gt;在瞬息万变的今天，新的事物太多太多，每天都是一个不一样的世界。&lt;/p&gt;

&lt;p&gt;听说人工智能很热，大家都觉得很酷，就有人开始担心人工智能统治世界，或有人都觉得自己也要学学神经网络才行。&lt;/p&gt;

&lt;p&gt;可是神经网络这种上个世纪发明的东西，是哪些人让他变得很酷呢？我想应该是那些不担心自己做的东西会过时，不担心自己研究的东西不是热点的人吧。&lt;/p&gt;

&lt;p&gt;有时候，学习古老的的技术会觉得似乎没什么用，好害怕再过不久旧的技术就会被取代。一直以来都觉得自己学的东西不够前沿，不够酷，感觉自己这也不会，那也不会。但现在想想，那又怎样呢？没有必要让自己为了时代潮流而放弃目前的方向。这也想学，那也想学是不对的。毕竟看见路口就拐弯的话，往往都是回到原点的。&lt;/p&gt;

&lt;p&gt;我所羡慕的固执的人，他们能无畏地说出非某事某物不可的言论，他们能不想退路地一条路走到黑，他们能不顾外界的影响随自己的心而去。我想这才是学习乃至人生的真正方法。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;未来&quot;&gt;未来&lt;/h2&gt;

&lt;p&gt;大学算是过去一半了，在这个时候不免会担心未来。&lt;/p&gt;

&lt;p&gt;迷茫是一件好事情，那是有思考而有有选择的人的特权，但我想，能好好地做自己想做的事，过让自己感到快乐的日子，其实是很不错的。蓦直向前，不忘初心，那不是很好吗？&lt;/p&gt;

&lt;p&gt;2017.08.19 晚 于广州&lt;/p&gt;
</description>
        <pubDate>Sat, 19 Aug 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/08/19/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/19/post01/</guid>
        
        <category>生活</category>
        
        <category>文艺</category>
        
        
      </item>
    
      <item>
        <title>玥</title>
        <description>&lt;blockquote&gt;
  &lt;p&gt;皓洁为月，佳文成玉。凤鸟神珠，寄吾德馨。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;二十年有二月记&quot;&gt;二十年有二月记&lt;/h2&gt;

&lt;p&gt;是年丁酉，余及冠，自取表字为玥，记于此。&lt;/p&gt;

&lt;p&gt;自民国新学盛起，气象变化，又及文革之乱，礼乐俱废。今举国崇尚数理，新学鼎盛，余逆潮流而行，复辟旧习，以缅古人，并规行自勉。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;大学&quot;&gt;大学&lt;/h2&gt;

&lt;p&gt;前不久经过中大北门的牌坊，才发现背面铭着的是“格致诚正 修齐治平”，此中深意，引我沉思。&lt;/p&gt;

&lt;p&gt;中大入学读《大学》，很多人会觉得不明所以，此大学与彼《大学》到底是同一个东西吗？&lt;/p&gt;

&lt;p&gt;所谓大学，和《大学》中的明德、亲民、止于至善是关联的。所谓大学，和《大学》中的格物、致知、诚意、正心、修身、齐家、治国、平天下是一致的。&lt;/p&gt;

&lt;p&gt;君子之志，不在名利。大丈夫理当以治国平天下为己任，而真正的大学，则是提供一条实现理想的道路。潜心学术研究，求学问道于先生学人，就是格物致知。在大学的生活、交往、锻炼，我们的通识课、我们听的讲座、我们谈论的一切，都是诚其意、正其心、修其身的过程。创业、工作则是齐家，齐家乃能安邦平天下。&lt;/p&gt;

&lt;p&gt;朱子借大学所讲的理，至今依旧受用。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;回忆往事兼论教育&quot;&gt;回忆往事兼论教育&lt;/h2&gt;

&lt;p&gt;再前不久经过磨碟沙，见到很久前的酒楼仍在，如今已落败了许多，令我想起一段往事。&lt;/p&gt;

&lt;p&gt;本欲在此记下，兼论今日对教育之思考，然而夜已深，昏昏欲睡，便就此搁笔，待他日记起再叙。&lt;/p&gt;

&lt;p&gt;2017.08.05 凌晨 于佛山&lt;/p&gt;
</description>
        <pubDate>Sun, 06 Aug 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/08/06/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/08/06/post01/</guid>
        
        <category>生活</category>
        
        <category>文艺</category>
        
        
      </item>
    
      <item>
        <title>API调用研究</title>
        <description>&lt;h2 id=&quot;缘起&quot;&gt;缘起&lt;/h2&gt;

&lt;p&gt;有一段时间想从微博中获取数据，于是就向试一下用API获取数据。基于这个出发点，我学会了使用微博API，虽然并没有通过weiboAPI获得什么实际用到的数据。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;一管中窥豹&quot;&gt;一、管中窥豹&lt;/h2&gt;

&lt;p&gt;在使用API之前，我们有必要了解一下到底什么是API。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;API英文全称Application Programming Interface，即应用程序接口。接口（Interface）指两个独立部分用于传递信息的共同边界（a shared boundary across which two separate components of a computer system exchange information，from Wikipedia）。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;所谓接口，就像USB插口一样，插上去就能传递信息。API就是提供给应用程序使用的接口，应用程序通过这个接口就可以简单地获取信息，而不需要知道底层代码或工作机制等细节，就像我们使用移动硬盘时只需要知道怎么将USB插口接到电脑上而不需要知道计算机是怎样实现从硬盘拷贝数据的。&lt;/p&gt;

&lt;p&gt;这样的好处就是，我们获取数据时，早已有了预先定义好的通道，数据提供方已经将访问数据的方法打包好，我们直接用就可以了，不用担心到底是怎么访问数据的——这些琐事就交给新浪吧。当然，API也不只是用于获取数据，还能用于发送数据，即接口的传输可以是双向的。比如我们通过调用新浪微博的API不仅可以获取最新的微博消息，还能通过接口发布一则微博或评论。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;二牛刀小试&quot;&gt;二、牛刀小试&lt;/h2&gt;

&lt;p&gt;既然API是现成的数据获取渠道，那么调用方式也应该被精心设计，所以接口的调用应该是相对人性化的，也就是说对于要获取数据的一般用户，并不需要太深奥的知识都能使用，那么怎么调用API呢？&lt;/p&gt;

&lt;p&gt;以下以新浪微博API为例初探如何调用API。&lt;/p&gt;

&lt;p&gt;首先我们可以很容易找到&lt;a href=&quot;http://open.weibo.com/wiki/API&quot;&gt;新浪微博的API&lt;/a&gt;，里面有各种各样的接口（如图-1）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072901/pic01.jpg&quot; alt=&quot;图 - 1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;我们先从“获取最新的公共微博”开始，点入左边的链接&lt;a href=&quot;http://open.weibo.com/wiki/2/statuses/public_timeline&quot;&gt;statuses/public_timeline&lt;/a&gt;，可以看到里面有许多项内容——URL、支持格式、请求方式、是否需要登录等等（如图-2）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072901/pic02.jpg&quot; alt=&quot;图 - 2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;从这里我们可以知道这个接口调用要注意的东西，但现在我们似乎还看不懂，没关系我们，先把他放在一边，回到最初的问题上：如何调用API。&lt;/p&gt;

&lt;p&gt;要知道如何调用，首先我们我知道在哪调用，这里采用一种简洁的语言——Python来调用我们API，如果不会Python也没关系，事实上你只要学会运行一个python程序就可以调用API了。&lt;/p&gt;

&lt;h4 id=&quot;1-调用环境的搭建&quot;&gt;1. 调用环境的搭建&lt;/h4&gt;

&lt;p&gt;搭建调用环境听起来很高端，其实说白了就是装软件和设置的过程。&lt;/p&gt;

&lt;h6 id=&quot;-python的运行&quot;&gt;* Python的运行&lt;/h6&gt;

&lt;h6 id=&quot;-sdk的获取&quot;&gt;* SDK的获取&lt;/h6&gt;

&lt;p&gt;SDK即软件开发工具包（Software Development Kit），为了方便调用API，sina提供了各种语言下调用API的SDK，具体参见网站&lt;a href=&quot;http://open.weibo.com/wiki/SDK&quot;&gt;Weibo SDK&lt;/a&gt;。其中python的SDK是由大神廖雪峰&lt;a href=&quot;https://github.com/michaelliao&quot;&gt;github&lt;/a&gt;写的，他的git上也有一些python教程。关于SDK，可以戳：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;下载页&lt;a href=&quot;https://github.com/michaelliao/sinaweibopy&quot;&gt;新浪微博Python SDK&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;介绍页&lt;a href=&quot;http://github.liaoxuefeng.com/sinaweibopy/&quot;&gt;sinaweibopy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h6 id=&quot;-创建应用&quot;&gt;* 创建应用&lt;/h6&gt;

&lt;p&gt;我们要调用数据，数据提供者必然不能随便开放数据，在新浪微博API中，要获取数据，就需要app-key和app-secret。这两个东西就像是账号密码，用来证明你是开发者，通过你开发的这个应用来使用API。&lt;/p&gt;

&lt;p&gt;要获得app-key和app-secret，我们首先要有一个app-，我们在&lt;a href=&quot;http://open.weibo.com/&quot;&gt;新浪开发平台&lt;/a&gt;上创建一个应用，点击我的应用，然后认证信息后，点击微连接-其他，创建一个网页应用，不需要审核。&lt;/p&gt;

&lt;p&gt;然后在【应用信息-基本信息】里面的app-key和app-secret（如图-3）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072901/pic03.png&quot; alt=&quot;图 - 3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;在【应用信息-高级信息】里面【OAuth2.0授权设置】（如图-4）里输入回调地址，这个地址是授权后跳转的页面，你可以自己做一个网页作为回调页，也可以随便找一个网页作为回调页，图中我用的是我自己做的一个简易页面。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072901/pic04.png&quot; alt=&quot;图 - 4&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;2-尝试调用&quot;&gt;2. 尝试调用&lt;/h4&gt;

&lt;p&gt;在任意路径新建一个文件夹作为代码存储区，也作为我们的工作环境。&lt;/p&gt;

&lt;p&gt;将SDK里的文件复制进该文件夹中。&lt;/p&gt;

&lt;p&gt;新建一个文本文档，命名随意但后缀要为.py，我们将通过这个文件来调用API，注意创建的文档要是纯文本文档。&lt;/p&gt;

&lt;p&gt;然后在文档中粘贴以下代码（&lt;a href=&quot;https://github.com/codeRimoe/api/blob/master/weiboAPI/apicode/demo1_pub_timeline.py&quot;&gt;demo1_pub_timeline.py&lt;/a&gt;），我们试着用下面这段代码来扒一些简单的数据吧。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# _*_ coding: utf-8 _*_&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;weibo&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;webbrowser&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;reload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;                                              &lt;span class=&quot;c&quot;&gt;# 使用UTF-8输出&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setdefaultencoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;APP_KEY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'xxx'&lt;/span&gt;             &lt;span class=&quot;c&quot;&gt;# 将引号中的xxx替换为你的APP_KEY，保留引号&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;MY_APP_SECRET&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'yyy'&lt;/span&gt;       &lt;span class=&quot;c&quot;&gt;# 将引号中的yyy替换为你的APP_SECRET，保留引号&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;REDIRECT_URL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'zzz'&lt;/span&gt;        &lt;span class=&quot;c&quot;&gt;# 将引号中的zzz替换为你的回调地址，保留引号&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 请求用户授权的过程&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weibo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;APIClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;APP_KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MY_APP_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;            &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;authorize_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_authorize_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;REDIRECT_URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;      &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 自动打开浏览器，授权后复制地址栏中URL里的code字段&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;webbrowser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;authorize_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;                              &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 将code字段后的值复制输入&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;raw_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;input the code: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;                &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 获得用户授权&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request_access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;REDIRECT_URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 保存返回的access_token,exires_in,uid&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;                         &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;expires_in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expires_in&lt;/span&gt;                             &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uid&lt;/span&gt;                                           &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 设置accsess_token&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expires_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;           &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 调用API&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;statuses__public_timeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'statuses'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;    &lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-----------the results is : &quot;&lt;/span&gt;                        &lt;span class=&quot;c&quot;&gt;# 输出信息&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;                                       &lt;span class=&quot;c&quot;&gt;# 确定获取的信息条数&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'昵称：'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'user'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'screen_name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; \
        &lt;span class=&quot;s&quot;&gt;' 来自：'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'user'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'location'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'时间：'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'created_at'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'来源：'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'source'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'微博：'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'text'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'转发：'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'reposts_count'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; \
        &lt;span class=&quot;s&quot;&gt;' 评论：'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'comments_count'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; \
        &lt;span class=&quot;s&quot;&gt;' 喜欢：'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'attitudes_count'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-----------all--------------&quot;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;在运行这段代码之前，我们要先将app-key和app-secret放进代码中，这样新浪微博才知道谁要调用这些数据。当然我们也要把回调地址写上，注意要和上面创建APP时你填的地址一样。&lt;/p&gt;

&lt;p&gt;然后我们在终端中运行这段代码。如无意外，代码运行后，终端会提示输入code，同时浏览器会打开，然后会出现授权提示页面（如图-5）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072901/pic05.png&quot; alt=&quot;图 - 5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这是选择授权就会跳转到授权提示页面，我们需要将跳转后的URL地址中的“code=”后面的部分复制，输入到终端中（如图-6）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072901/pic06.png&quot; alt=&quot;图 - 6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;然后我们就能看到终端上显示出了我们扒下来的数据(可以写文件保存：&lt;a href=&quot;https://github.com/codeRimoe/api/tree/master/weiboAPI/result_example&quot;&gt;result.txt&lt;/a&gt;)啦（如图-7）！&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072901/pic07.jpg&quot; alt=&quot;图 - 7&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;三更上层楼&quot;&gt;三、更上层楼&lt;/h2&gt;

&lt;p&gt;API实质上是访问网站数据库的窗口，我们递交一个申请，网站返回数据，API和爬虫不同，爬虫是模拟人访问网页的行为获取网页，然后在获取的网页上提取数据，并通过网页的链接跳转继续获取数据，而API则是向服务器发送请求，服务器返回json格式的文件。所以API其实是官方提供的数据获取源。通常会对数据流量有一定的限制。&lt;/p&gt;

&lt;p&gt;因此API调用的本质是：发送请求-&amp;gt;返回数据-&amp;gt;解析数据&lt;/p&gt;

&lt;h4 id=&quot;1-http请求&quot;&gt;1. HTTP请求&lt;/h4&gt;

&lt;p&gt;首先我们要发送的请求是通过HTTP进行请求的，HTTP的请求方式有几种：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;HTTP1.0定义了三种请求方法： GET, POST 和 HEAD方法。&lt;/li&gt;
  &lt;li&gt;HTTP1.1新增了五种请求方法：OPTIONS, PUT, DELETE, TRACE 和 CONNECT 方法。&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;方法&lt;/td&gt;
      &lt;td&gt;描述&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;GET&lt;/td&gt;
      &lt;td&gt;请求指定的页面信息，并返回实体主体。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;HEAD&lt;/td&gt;
      &lt;td&gt;类似于get请求，只不过返回的响应中没有具体的内容，用于获取报头。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;POST&lt;/td&gt;
      &lt;td&gt;向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的建立和/或已有资源的修改。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;PUT&lt;/td&gt;
      &lt;td&gt;从客户端向服务器传送的数据取代指定的文档的内容。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;DELETE&lt;/td&gt;
      &lt;td&gt;请求服务器删除指定的页面。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;CONNECT&lt;/td&gt;
      &lt;td&gt;HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;OPTIONS&lt;/td&gt;
      &lt;td&gt;允许客户端查看服务器的性能。&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;TRACE&lt;/td&gt;
      &lt;td&gt;回显服务器收到的请求，主要用于测试或诊断。&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;一般用到的就只有GET和POST，区别大概是GET用于获取数据，POST要在header中提交更多的参数用于提交数据。我们浏览网页，实际上是提交一个表单，向服务器请求数据。关于http协议的教程，具体可以看&lt;a href=&quot;http://www.runoob.com/http/http-tutorial.html&quot;&gt;HTTP教程&lt;/a&gt;，具体请求方式python中一般是使用urllib和urllib2两个模块的urlopen()函数。&lt;/p&gt;

&lt;p&gt;我们在微博API的使用手册中可以看到，每个API都有写明HTTP请求方式，使用SDK可以不需要深入了解HTTP请求方式即可调用API。&lt;/p&gt;

&lt;h4 id=&quot;2-oauth授权简介&quot;&gt;2. OAuth授权简介&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;p&gt;OAuth是一个关于授权(authorization)的开放网络标准,在全世界得到广泛应用,目前的版本是2.0版。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;新浪微博API采用OAuth2.0授权，具体原理可以参考&lt;a href=&quot;http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html&quot;&gt;理解OAuth 2.0&lt;/a&gt;，这里我们只需要知道通过授权码认证后，我们的程序可以获得用户账号的某些权限，比如查看微博、发微博等。这个授权码，其实就是上文提到“code=”后面的那串字符。&lt;/p&gt;

&lt;h4 id=&quot;3-使用sdk&quot;&gt;3. 使用SDK&lt;/h4&gt;

&lt;p&gt;使用SDK很方便的一点就是可以不用管这些，直接就使用SDK（weiboAPI模块）里的函数。&lt;/p&gt;

&lt;p&gt;上文demo.py中调用了几个函数:&lt;/p&gt;

&lt;p&gt;其中client.get_authorize_url()函数可以返回授权页；&lt;/p&gt;

&lt;p&gt;client.request_access_token()用于获得包括access_token的返回数据；&lt;/p&gt;

&lt;p&gt;使用client.set_access_token()函数设置access_token后就可以调用API了。&lt;/p&gt;

&lt;p&gt;API接口有很多，demo中调用的是公众时间流，可以获取公共微博数据。这些接口的调用方式在微博开放平台-&lt;a href=&quot;http://open.weibo.com/wiki/%E5%BE%AE%E5%8D%9AAPI&quot;&gt;微博API&lt;/a&gt;中可以找到。&lt;/p&gt;

&lt;p&gt;比如当前用户关注的人的最新微博的API&lt;a href=&quot;http://open.weibo.com/wiki/2/statuses/home_timeline&quot;&gt;statuses/home_timeline&lt;/a&gt;其URL是”https://api.weibo.com/2/statuses/home_timeline.json”，调用就可以直接使用如下方法，其实就是把“/”换成“.”，然后后面加上请求方式（.get/.post）。&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;statuses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;home_timeline&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果要调用某些API需要提交请求参数的，那就在括号里面加上参数名=具体参数，如&lt;a href=&quot;http://open.weibo.com/wiki/2/comments/create&quot;&gt;comments/create&lt;/a&gt;（这个API是POST请求方式,请求参数如图-8），那就应该写成如下形式。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072901/pic08.png&quot; alt=&quot;图 - 8&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comments&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;你好帅啊！&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                          &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4129569084024445&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;调用后结果如下：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072901/pic09.png&quot; alt=&quot;图 - 9&quot; /&gt;&lt;/p&gt;

&lt;p&gt;用API发条评论也是很有趣的嘛～&lt;/p&gt;

&lt;h4 id=&quot;4-访问频次&quot;&gt;4. 访问频次&lt;/h4&gt;

&lt;p&gt;API接口不是无限次数访问的，官方文档-&lt;a href=&quot;http://open.weibo.com/wiki/Rate-limiting&quot;&gt;接口访问频次权限&lt;/a&gt;这样写道：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;微博开放接口限制每段时间只能请求一定的次数。限制的单位时间有每小时、每天；限制的维度有单授权用户和单IP；部分特殊接口有单独的请求次数限制。例如：&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;一个应用内单授权用户每小时只能请求微博开放接口n次；&lt;/li&gt;
    &lt;li&gt;一个应用内单授权用户每天累计只能请求微博开放接口m次；&lt;/li&gt;
    &lt;li&gt;一个IP地址每小时只能请求微博开放接口x次；&lt;/li&gt;
    &lt;li&gt;发微博接口单授权用户每小时只能请求y次；
其中n、m、x、y的具体数值，微博开放平台将采用应用质量评估系统，实现智能评估应用质量，质量高的应用相应的这些数值就高，也就是请求限制小。因此限制值不固定，不同的应用有不同的限制，取决于应用自身的质量。&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;使用API接口&lt;a href=&quot;http://open.weibo.com/wiki/2/account/rate_limit_status&quot;&gt;account/rate_limit_status&lt;/a&gt;，可以查看当前应用的频次限制。&lt;/p&gt;

&lt;h4 id=&quot;5-自动获取授权码&quot;&gt;5. 自动获取授权码&lt;/h4&gt;

&lt;p&gt;这部分由于各种原因没有去研究，以后不知道什么时候才有空去研究，这里先贴一个链接：&lt;a href=&quot;http://blog.csdn.net/liujiandu101/article/details/52096654&quot;&gt;python模拟登录新浪微博自动获得调用新浪api所需的code&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;大概看了一下好像就是直接用requests请求的。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;四返躬内省&quot;&gt;四、返躬内省&lt;/h2&gt;

&lt;p&gt;一开始研究API是为了通过API获取微博的数据，但后来发现，API对频次的限制比较严格，而且获取的方法比较单一，后来就转向使用爬虫。但如果要获取用户间的关系的话，使用API似乎也是可行的。&lt;/p&gt;

&lt;p&gt;API的用途更多是用在应用接入方面，比如用在我们用某些软件或网页中的“分享到新浪微博”的接口，还是有其作用的。&lt;/p&gt;

&lt;p&gt;另外新浪微博的API和twitter的API是很像的，《社交网站的数据挖掘与分析》第一章讲的就是twitte的API使用方法，大家有空可以看看。&lt;/p&gt;

&lt;p&gt;其实这篇文章大约半年前就开始写了，最近才将之前的东西整理了一下，接下来我会写几篇关于上学期学习简单爬虫的艰苦历程，可能还会研究一下百度地图的API，不过不知道什么时候才能写出来。&lt;/p&gt;

&lt;p&gt;代码已发到&lt;a href=&quot;https://github.com/codeRimoe/api&quot;&gt;Github - api&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;代码参考自：&lt;a href=&quot;http://blog.csdn.net/dijason/article/details/8251322&quot;&gt;微博 获取指定用户发表的所有微博&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2017.07.27 于广州&lt;/p&gt;
</description>
        <pubDate>Sat, 29 Jul 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/07/29/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/07/29/post01/</guid>
        
        <category>Python</category>
        
        <category>API/SDK</category>
        
        <category>数据获取</category>
        
        <category>技术</category>
        
        <category>微博</category>
        
        
      </item>
    
      <item>
        <title>大概是最弱鸡的2D仿真</title>
        <description>&lt;h2 id=&quot;缘起&quot;&gt;缘起&lt;/h2&gt;

&lt;p&gt;大二下学期的基础课特别多，大作业也特别多，就在几周前，我在大作业与考试复习的夹缝里顽强地生存。&lt;/p&gt;

&lt;p&gt;大概是一个模拟草原上狼吃羊的过程，要求C++语言，使用OOP思想，使用图像可视化。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;实验过程&quot;&gt;实验过程&lt;/h2&gt;

&lt;p&gt;具体的实验报告可以在&lt;a href=&quot;https://github.com/codeRimoe/Wolf_and_Sheep&quot;&gt;GitHub - Wolf and Sheep&lt;/a&gt;上看，这里就不多叙述惹。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic01.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;狼和羊的人工智障&quot;&gt;狼和羊的人工智障&lt;/h2&gt;

&lt;p&gt;比原来的要求增加了一些东西，优化的移动策略：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;狼会往狼多的方向移动&lt;/li&gt;
  &lt;li&gt;羊会往远离追逐他的狼的方向逃跑，往狼少的地方移动&lt;/li&gt;
  &lt;li&gt;繁殖时会为出生的宝宝选择最佳出生位置&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;实现方法非常简单，其实就是计算权重，也就是提供了一个决策方案的实现思路，越优先的考虑节点的权重乘以越高的位置。原理相当于设计一个函数计算优先度，我们考虑问题往往会一层一层的考虑比较（类似于决策树）。&lt;/p&gt;

&lt;p&gt;如下图，羊首先考虑有没有狼在身边，一步就能吃掉自己，其次考虑移动后附近狼的数目多少，最后考虑移动后的草的数量。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic02.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;因为活命永远是最重要的，所以首先不要逃离最接近的狼，然后再长远考虑移动后的情况。最后权重计算公式是W=A&lt;em&gt;w1+B&lt;/em&gt;w2+C*w3，这里的为w1、w2、w3参数是可以变化的，具体要视情况而定，这个线性模拟策略参数设置可以考虑通过神经网络模型等得出。当然这里保证A、B、C小于10，将参数w1、w2、w3分别设为100、10、1，就可以得到一种简单的模拟方式：就是先比较A，再比较B，再比较C，只要策略一的A比策略二的大，就不考虑BC的值。&lt;/p&gt;

&lt;p&gt;这部分也不是本文重点，就此略过。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;可视化qt&quot;&gt;可视化（QT）&lt;/h2&gt;

&lt;p&gt;最后我选择QT进行可视化，其中一个原因是QT是开源的，最重要的原因是跨平台，对于使用MacOS的我来说，写作业给老师比较烦就是老师用的是Windows，好多库都是不一样的。QT可以跨三个平台，大概有点不好的就是UI文件会有点错位，不过关系不大。&lt;/p&gt;

&lt;p&gt;QT是一个可视化架构，通过QT可以很容易做出一些比较好看耐用的交互界面。而QT creator则是一个配套的IDE。&lt;/p&gt;

&lt;p&gt;QT简介请看：&lt;a href=&quot;http://blog.csdn.net/xuancailinggan/article/details/50620829&quot;&gt;关于QT、QT creator和编译器，新手入门必知的一些知识&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic03.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;1-qt的安装与配置&quot;&gt;1. QT的安装与配置&lt;/h4&gt;

&lt;p&gt;对于MacOS来说，下载一个QT Creater，这是一个大概是IDE的东西。感觉Mac版的话要自己配置Qt版本，之前我搞了好久都不行。建议安装编译器的时候用brew安装，&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;brew update
brew install qt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;安装成功后然后终端会提示安装的路径（大概是/usr/local/Cellar/qt/5.9.0），然后在Qt Creator中设置版本（偏好设置-&amp;gt;构建与运行-&amp;gt;Qt Version-&amp;gt;添加…）。这里最坑的是Mac的打开文件窗口不能直接访问系统保护的目录，这里有几个方法，一是直接Command+Shift+G，输入路径，二是前往文件夹或者终端cd路径，然后创建个快捷方式（替身），然后通过替身跳到文件夹。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic04.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic05.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;配置完就可以使用了，左下角有个类似资源管理器的东西，选“项目”里面会有工程文件的Source和资源文件等。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic06.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;然后旁边可以选择编译器、release、debug、build。&lt;/p&gt;

&lt;p&gt;在Windows下的安装就傻瓜得多了，大概就是一个引导程序，比较傻瓜的装好就OK。编译器建议只选MingW的就够了。&lt;/p&gt;

&lt;h4 id=&quot;2-qt的控件对象&quot;&gt;2. QT的控件对象&lt;/h4&gt;

&lt;p&gt;QT的工程文件是.pro，项目的文件框架如下图所示。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic07.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Headers和Source是头文件和源文件，一般就是cpp实现的Source，Form是.ui文件，大概就是初始界面的框架。Resources是资源文件，一些图片一般放在里面用于调取。&lt;/p&gt;

&lt;p&gt;.ui文件可以在“设计“模式（designer）中直接画出窗口相应的框架，这个有点像VB，如下图所示。这里指出在windows下里面的控件对象会错位。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic08.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;操纵窗口是通过工程创建的一个类MainWindow实现的。该类相当于是一个窗口，包含一个指针成员ui，调用窗口的预先绘制好控件对象时，使用ui-&amp;gt;ObjName作为对象名使用，尤其菜单栏，状态栏等就更应该如此。&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;ui&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mainToolBar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setFixedHeight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//设置工具栏高度为10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;当然，还可以自己创建控件对象，为了方便调用自己创建的对象，一般在MainWindow类中会创建一个指针成员，用于记录该对象。&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;timer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;QTimer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;//创建一个QTimer，之后可以使用timer来调用该对象
&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/* ----------------- */&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;               &lt;span class=&quot;c1&quot;&gt;//一般在析构函数中会调用delete删除对象
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;简而言之，QT是通过控制控件对象完成界面操作的。&lt;/p&gt;

&lt;h4 id=&quot;3-qt的资源库&quot;&gt;3. QT的资源库&lt;/h4&gt;

&lt;p&gt;前面说到QT的resources文件夹用于存放资源，比如图片素材这类东西就可以放在里面，以备调用。&lt;/p&gt;

&lt;p&gt;在右下角文件管理器中选项目，Resources文件夹右键-添加新文件，创建一个.qrc文件，然后往.qrc文件中添加资源，自后就可以调用其中的资源了。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic09.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017072701/pic10.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;QImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;:/jpg/resource/green.png&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;//从资源库调取文件green.png
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pLabel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setPixmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;QPixmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fromImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//在QLabel中显示图片
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;4-qt的信号-槽机制&quot;&gt;4. QT的信号-槽机制&lt;/h4&gt;

&lt;p&gt;信号与槽是QT的两个重要概念，两者可以将不同对象联系起来，使程序更安全简洁。&lt;/p&gt;

&lt;p&gt;信号指的是对象发出的触发指令，槽则是接受信号并触发的函数，两者以connect函数连接起来。&lt;/p&gt;

&lt;p&gt;可以参考文章&lt;a href=&quot;http://www.cnblogs.com/MuyouSome/p/3515941.html&quot;&gt;Qt入门之信号与槽机制&lt;/a&gt;。&lt;/p&gt;

&lt;div class=&quot;language-cpp highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MainWindow&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;QMainWindow&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;Q_OBJECT&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;explicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MainWindow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;QWidget&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MainWindow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//other code...
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;slots&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//槽函数必须要在类的public/private/protected slots中声明，否则无法使用
&lt;/span&gt;    &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//语法：connect(sender, SIGNAL(signal), receiver, SLOT(slot));
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pushButton1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIGNAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clicked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SLOT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()));&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pushButton2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIGNAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clicked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SLOT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;5-qt的编译打包&quot;&gt;5. QT的编译打包&lt;/h4&gt;

&lt;p&gt;release编译后，将.exe文件提取出来，用Qt命令行使用windeployqt来拷贝依赖包即可发布。&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;windeployqt Programme.exe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;命令自动会将程序需要的第三方库（.dll文件）复制到.exe文件的的路径中。&lt;/p&gt;

&lt;p&gt;在Mac下生成的app文件，也可以用macdeployqt来进行依赖库拷贝。&lt;/p&gt;

&lt;p&gt;具体可以参考：&lt;a href=&quot;http://blog.csdn.net/liuyez123/article/details/50462637&quot;&gt;Qt 程序打包发布总结&lt;/a&gt;。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;后记&quot;&gt;后记&lt;/h2&gt;

&lt;p&gt;做这个课程作业最大的收获大概就是接触到QT，可以将一些小程序可视化，能够做出一个界面，这个过程也是挺有趣的。&lt;/p&gt;

&lt;p&gt;代码已发到&lt;a href=&quot;https://github.com/codeRimoe/h5_game_kanna&quot;&gt;Github - h5_game_kanna&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;2017.07.27 于广州&lt;/p&gt;
</description>
        <pubDate>Thu, 27 Jul 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/07/27/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/07/27/post01/</guid>
        
        <category>C/C++</category>
        
        <category>QT</category>
        
        <category>可视化</category>
        
        <category>仿真</category>
        
        <category>技术</category>
        
        
      </item>
    
      <item>
        <title>胡乱写了个小游戏</title>
        <description>&lt;h2 id=&quot;缘起&quot;&gt;缘起&lt;/h2&gt;

&lt;p&gt;H5通识课作业要求写一个小游戏，那就写吧，5月30日晚从香港回到学校，就开始着手撸起来。&lt;/p&gt;

&lt;p&gt;本来想做一个像机械迷城一样的H5游戏，但想想工程量太大赶不及交作业，而且最近事还不少，于是就想着做一个简单一点的。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;游戏设计&quot;&gt;游戏设计&lt;/h2&gt;

&lt;p&gt;因为没有想法，所以上网找了一下别人blog的文章，于是发现了一篇2011年的文章&lt;a href=&quot;http://www.lostdecadegames.com/how-to-make-a-simple-html5-canvas-game/&quot;&gt;《How to make a simple HTML5 Canvas game》&lt;/a&gt;，这也是有够古老的，但足够简单。&lt;/p&gt;

&lt;p&gt;但是只是上下左右吃小妖怪这样的设定既不有趣也不可爱，而且也不可能直接copy别人的代码交作业。&lt;/p&gt;

&lt;p&gt;所以结合以前玩过的一个叫泡泡堂的游戏来了灵感，设计了一个小游戏。&lt;/p&gt;

&lt;p&gt;·玩家通过控制一个角色单位的【移动】和【放炸弹】来躲避并消灭怪物。&lt;/p&gt;

&lt;p&gt;·怪物定时产生，跟随玩家角色移动，碰到玩家角色即消失，玩家扣血。&lt;/p&gt;

&lt;p&gt;·胜利条件是杀敌数一定或一定时间内不死。&lt;/p&gt;

&lt;p&gt;·当然怪物、炸弹可以有不同类型和效果。&lt;/p&gt;

&lt;p&gt;然后为了变得萌萌哒就把游戏做成《小林家的龙女仆》的同人啦。&lt;/p&gt;

&lt;p&gt;设定是托尔追坎娜，后来又加上一个不动的小林在中间，游戏中不能碰到。&lt;/p&gt;

&lt;p&gt;（有人问我为什么是坎娜不是康娜，其实就是单纯喜欢这个小众的译名（误）。）&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017060901/pic01.jpg&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;构建对象与移动&quot;&gt;构建对象与移动&lt;/h2&gt;

&lt;p&gt;说干就干，首先要构建对象，先构建了三个对象，一是坎娜，二是托尔，三是炸弹。后来又加了个小林类。&lt;/p&gt;

&lt;p&gt;基本上都有img、x、y、hp这三个数据成员，其实可以搞个基类的，不过当时有点赶着写完于是就直接撸没有设计类。&lt;/p&gt;

&lt;p&gt;类图大概是下面这样的。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017060901/pic02.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;画图、移动、设置炸弹，另外写了几个检查状态的函数。&lt;/p&gt;

&lt;p&gt;键盘输入控制的话，当然是用键盘的上下左右啦，其实这个也只是设置一个监听。&lt;/p&gt;

&lt;p&gt;代码如下&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;c1&quot;&gt;//监听键盘事件&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keysDown&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{};&lt;/span&gt;                                     &lt;span class=&quot;c1&quot;&gt;//记录当前按着的键&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keydown&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;keysDown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keyCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;keyup&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keysDown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keyCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;keyCode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/*add key value*/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/*add code*/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;//松开某键盘执行代码&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/*add key value*/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/*add code*/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//检测长按对应事件&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;Kanna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;move&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//使用（value in dictionary）判断&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;38&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keysDown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;spd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keysDown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;spd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;37&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keysDown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;spd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;39&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;keysDown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;spd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CBH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CBH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CBW&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;CBW&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;48&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;kanna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;kanna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;kimg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;kanna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;kimg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;其他的话就是托尔跟踪的函数了，算法大概就是每次算出xy差值，然后得到连线斜率，然后用速度算一下移动的xy值。&lt;/p&gt;

&lt;p&gt;游戏实现方面还是比较简单的。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;手机端支持g感应&quot;&gt;手机端支持（G感应）&lt;/h2&gt;

&lt;p&gt;本来只做PC端就能交作业了，但我突然觉得h5不做手机端这游戏发在票圈里肯定没人玩了，于是我就开始研究手机端了。&lt;/p&gt;

&lt;p&gt;第一个问题首先是如何检测网页在手机端打开，为了图方便就直接用了别人的库&lt;a href=&quot;https://github.com/matthewhudson/device.js/blob/master/lib/device.js&quot;&gt;Device.js&lt;/a&gt;,然后就直接用device.mobile()判断就OK了。&lt;/p&gt;

&lt;p&gt;然后控制的话当然是触摸画板放炸弹了，很简单就直接加一个object.onclick()就可以了，不过这里mark一下，canvas是不能直接onclick的，我们要造一个div然后get这个div再div.onclick()。&lt;/p&gt;

&lt;p&gt;至于移动的话，我先是想用触摸canvas外的空白处，但一是不好实现，二是用户不好操作，三是竖屏状态下自适应后没有空白了，后来我就想到G感应。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017060901/pic03.jpg&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;首先我去找了些文章，比较有参考价值的是&lt;a href=&quot;http://blog.csdn.net/hursing/article/details/9046837&quot;&gt;iOS Safari/WebKit对DeviceOrientationEvent的实现&lt;/a&gt;。其实准确来说，用的应该是陀螺仪。手机有加速度感应和陀螺仪两个传感器，前者感应手机的加速度，后者感应手机旋转角度，参考自&lt;a href=&quot;http://www.haorooms.com/post/html5_DeviceMotionEvent&quot;&gt;html5重力感应事件之DeviceMotionEvent&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;陀螺仪的监听器是”deviceorientation”，监听手机的转动，即手机一转动就触发监听。返回5个值：webkitCompassHeading，webkitCompassAccuracy，alpha，beta，gamma。&lt;/p&gt;

&lt;p&gt;webkitCompassHeading：与正北方向的角度差值。正北为0度，正东为90度，正南为180度，正西为270度。&lt;/p&gt;

&lt;p&gt;webkitCompassAccuracy：指北针的精确度，表示偏差为正负多少度。一般是10。&lt;/p&gt;

&lt;p&gt;alpha: 在围绕 z 轴旋转时，手机屏幕面转过的度数，设备顶部指向地球正北方向时为0，取值[0,360]。&lt;/p&gt;

&lt;p&gt;beta: 在围绕 x 轴旋转时，手机屏幕面转过的度数，设备水平放置时为0，取值[-180,180]。&lt;/p&gt;

&lt;p&gt;gamma: 在围绕 y 轴旋转时），手机屏幕面转过的度数，设备水平放置时为0，取值[-90,90]。&lt;/p&gt;

&lt;p&gt;具体的直观感受请就看下图：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017060901/pic04.png&quot; alt=&quot;avatar&quot; /&gt;
&lt;img src=&quot;/img/in-post/2017060901/pic05.png&quot; alt=&quot;avatar&quot; /&gt;
&lt;img src=&quot;/img/in-post/2017060901/pic06.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;我们可以发现这里的原理很简单，大概是：通过正北（地磁场感应）判断alpha，通过重力加速度方向（重力感应）确定beta和gamma。&lt;/p&gt;

&lt;p&gt;我们这里只用到beta和gamma，也就是说所谓的G感应其实是陀螺仪的两个返回值。&lt;/p&gt;

&lt;p&gt;所以每当监听到转动时就往keysdown字典里添加对应方向的keycode，检测到轴线水平时删除该轴线上两个方向的keycode。当然，我设置了允许5度以内的偏差，就是返回正负5度都认为是水平。&lt;/p&gt;

&lt;p&gt;此外要注意横屏时的方向和竖屏的不一样，利用window.orientation可以返回-90、0、90、180分别代表屏幕四个方向。&lt;/p&gt;

&lt;p&gt;手机端测试时比较麻烦的是要先推到网站上再用手机打开，开始以为chrome的设备模拟不支持GSencor，后来发现是有Sencor模拟的。
&lt;img src=&quot;/img/in-post/2017060901/pic07.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;另外我还发现chrome有remote devices功能，可以用USB连上手机，这次没用上，下次可以探索一下。
&lt;img src=&quot;/img/in-post/2017060901/pic08.png&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;网页自适应&quot;&gt;网页自适应&lt;/h2&gt;

&lt;p&gt;网页自适应对我来说一直挺麻烦的，可能是因为CSS和Style没学好，其实个人觉得吧，CSS写错了都不知道哪出问题，颇为心累。&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;坎娜与托尔 - Rimoe Game&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;user-scalable=0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;viewport&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;style&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;98%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;98%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;justify-content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;center&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;align-items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;center&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;   
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这里mark一下meta里面的user-scalable=0，这样的话可以避免双击放大，在游戏中就很好地避免狂点屏幕放大网页的问题。&lt;/p&gt;

&lt;p&gt;限时设置html和body的宽高98%，避免100%时出现滚动条，然后我用js控制缩放，直接修改div.style.zoom（缩放）。&lt;/p&gt;

&lt;p&gt;因为canvas一开始就设置好宽高多少px，如果后面改的话其他图片大小什么的也要改，所以直接采用缩放的办法。用document.body.clientWidth和Height获取宽高，求其与画板的比值作为缩放尺度。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;后记&quot;&gt;后记&lt;/h2&gt;

&lt;p&gt;随便撸了个小游戏成就感还是很足的，H5和JS开发还是挺有趣的，最重要的是网页作为现在最重要的信息载体，是最值的关注的内容，个人觉得JS是挺有学习的意义的，易上手还好看，与C、Jave那些不一样，容易装逼。&lt;/p&gt;

&lt;p&gt;不过这次的代码写的并不完美，挺混乱的。&lt;/p&gt;

&lt;p&gt;嗯，本人的H5学习之路还要任重道远呢。&lt;/p&gt;

&lt;p&gt;代码已发到&lt;a href=&quot;https://github.com/codeRimoe/h5_game_kanna&quot;&gt;Github - h5_game_kanna&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;2017.06.09 于珠海&lt;/p&gt;
</description>
        <pubDate>Fri, 09 Jun 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/06/09/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/06/09/post01/</guid>
        
        <category>H5/JS</category>
        
        <category>游戏</category>
        
        <category>技术</category>
        
        
      </item>
    
      <item>
        <title>为政之学与入徳之门</title>
        <description>&lt;h2 id=&quot;本文缘起&quot;&gt;本文缘起&lt;/h2&gt;

&lt;p&gt;本学期选了一门通识课，《礼记》导读，因交作业作了一篇文章，遂记录于此。&lt;/p&gt;

&lt;p&gt;原文题为《〈四书·大学〉与〈礼记·大学〉之异》，本文在原文上有作修改。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;两版本大学之异&quot;&gt;两版本大学之异&lt;/h2&gt;

&lt;p&gt;目前《大学》主要有两个版本，一是&lt;a href=&quot;https://zh.wikisource.org/wiki/%E7%A6%AE%E8%A8%98%E6%AD%A3%E7%BE%A9/60&quot;&gt;《礼记·大学》&lt;/a&gt;，二是&lt;a href=&quot;https://zh.wikisource.org/wiki/%E5%9B%9B%E6%9B%B8%E7%AB%A0%E5%8F%A5%E9%9B%86%E8%A8%BB/%E5%A4%A7%E5%AD%B8%E7%AB%A0%E5%8F%A5&quot;&gt;《四书·大学》&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;此处《礼记·大学》即《礼记·大学第四十二》原文，《四书·大学》是南宋朱熹的《四书章句集注·大学章句集注》。二者有许多不同，如在篇目顺序上，《四书·礼记》经过朱子的移文补传，体系更为严谨。&lt;/p&gt;

&lt;p&gt;《礼记·大学》可以分为“道”、“诚意篇”、“正心篇”、“修身篇”、“治国篇”，《四书·大学》则是“经”一章与“传”十章的结构，又补朱子《格物致知补传》，诚意篇往后编排，形成以“明明德”、“新民”、“止于至善”为&lt;strong&gt;三纲&lt;/strong&gt;，以“格物”、“致知”、“诚意”、“正心”、“修身”、“齐家“、“治国“、”平天下”为&lt;strong&gt;八目&lt;/strong&gt;的理论体系。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017051201/pic01.jpg&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;大学新义与其在四书中定位&quot;&gt;《大学》新义与其在《四书》中定位&lt;/h2&gt;

&lt;p&gt;朱子移文补传，实是借古文立新学，《大学》原文经朱子一番悉心打扮后，不仅形式变更了，含意也变得有所不同。
朱子在《大学章句·序》中写道：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;“及周之衰，賢聖之君不作，學校之政不修，教化陵夷，風俗頹敗，時則有若孔子之聖，而不得君師之位以行其政教，於是獨取先王之法，誦而傳之以詔後世。”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017051201/pic02.jpg&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;可见，朱子对《大学》赞赏有嘉，认为这是教化风俗的学问，因此将此文从礼记中提出来，作为四书之一，定为“为学之纲”。&lt;/p&gt;

&lt;p&gt;《礼记·大学》原为《小戴礼记》中的一篇，阐述的是一种“博学可以为政”的“太学”，讲的是如何以礼治国，而朱子对大学则有新的理解。他认为，《大学》讲的是从格物致知到治国平天下的“修德之学“，是四书里的”&lt;strong&gt;入徳之门&lt;/strong&gt;“。朱子在作集注时，提出了许多自己的看法，在有的人看来，这些章句曲解了原文，是伪学。但朱子反本开新，使得《四书·礼记》成为南宋后的“正统之学”，构成了理学发展的重要一环。&lt;/p&gt;

&lt;p&gt;朱子章句中，有许多对旧文的新解，援“亲，当作新”一句为例，《大学》中“在亲民”的“亲”字，被解释为新，这一注解，某种程度上是为了与后文“茍日新，日日新，又日新”所照应，但这一全新的诠释，使得《大学》从为政之道转变为入徳之学。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;补传与格物致知的新诠释&quot;&gt;补传与“格物致知”的新诠释&lt;/h2&gt;

&lt;p&gt;朱子的移文补传，包括对篇目的重新编排，形成了新的体系结构，还包括了补写了《格物致知补传》，解释“格物”与“致知”。&lt;/p&gt;

&lt;p&gt;朱子移文后，前三传分别解释了三纲，即“明明德”、“亲民”、“止于至善”，第四章解释“本末”，第六至八章解释了八目中的“诚意”、“正心修身”、“修身齐家”、“齐家治国”、“治国平天下”，唯独没解释“格物致知”。朱子认为第五章是“格物致知传”，但丢失了，故补一传。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;“右傳之五章，蓋釋格物、致知之義，而今亡矣。閒嘗竊取程子之意以補之。——朱熹《四书·大学》”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;而朱子补传的这一做法，是否符合《大学》之本意？&lt;/p&gt;

&lt;p&gt;朱子之所谓“格物”、“致知”，讲的是人有“&lt;strong&gt;认知天下之事物，把握事物之理&lt;/strong&gt;”的能力，讲人可以通过由认知事物而把握事物的“理”。后来，王阳明又提出了“诚意”、“致良知”为《大学》之本，提倡恢复古本《大学》。王阳明的学说重“诚意”，以孟子“良知”解释“致知”，强调“心即理”。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;“物者，事也，凡意之所发必有其事，意所在之事谓之物。格者，正也，正其不正以归于正之谓也。正其不正者，去恶之谓也。归于正者，为善之谓也。夫是之谓格。——王守仁《大学问》”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;王阳明认为“格物“、”致知”、“诚意”、“正心”本意都是一样，都是为了“修身”。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;“「格物」者,格其心之物也,格其意之物也,挌其知之物也:「正心」者,正其物之心也:「誠意」者,誠其物之意也:「致知」者,致其物之知也。此岂有内外彼此之分哉?——王守仁《传习录》”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;依照此观点，《礼记》不必将四者分开。由此观之，从王阳明的学说来理解“格物致知”，并不一定比朱子学说更加符合《礼记》原意。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017051201/pic03.jpg&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;钱穆先生在《〈大学〉格物新释》中提出，《大学》中并无对“物”的解释，而《大学》节选自《小戴礼记》，故对“格物”的理解应当在《小戴礼记》的别篇中找寻，并指出《礼记·乐记》中的“物至知知”便是对“格物致知”的解释：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;“人心所动，物使之然也。——《礼记·乐记》”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;体现了在“物”的经验后才有人的“知”，与朱子的解释相符，由此推断朱子的解释合理。&lt;/p&gt;

&lt;p&gt;但朱子的“格物致知”与《礼记·大学》提到的“格物致知”应当是不同的，我们所《礼记·大学》讲的是“为政之道”，为政的“格物“应当是不必”穷极事物之理以推极吾之知识“的，郑玄与孔颖达在《礼记正义》注疏中给出了理解：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;“格，來也。物、猶事也。其知於善深，則來善物。其知於惡深，則來惡物。言事緣人所好來也。——郑玄《礼记正义·注》”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;在郑孔二人的理解中，”格物“是果，”致知“是因，由一个人的格物来事而致其知，由果推因，以人之待物推知其知之善恶，因为只有知善者才能行善事。依照此观点，通过”格善物“，使得他人”致善知“，于是”诚意“、”正心“，”由天子以至庶人，壹是以修身为本“，从而”家齐国治天下平“。&lt;/p&gt;

&lt;p&gt;因此，朱子的理解是与郑孔所不同的。&lt;/p&gt;

&lt;p&gt;朱子补传，意在重新诠释”格物致知“的本义，从而使《大学》从”为政“之学泛化为”入徳“之学。&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;小议朱子移文补传&quot;&gt;小议朱子移文补传&lt;/h2&gt;

&lt;p&gt;朱子移文补传的理由是旧本错简、传文遗失，而其做法在日后亦备受诟病，如国学大师南怀瑾先生在《原本大学微言》中批判道：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;“其实，孔家老店，倒还货真价实，只是从南宋以后，这一班宋儒学家们，加入了孔家店，喧宾夺主，改变了孔家店原来的产品，掺入的冒牌太多。尤其以程、朱之说，更为明显。“&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/2017051201/pic04.jpg&quot; alt=&quot;avatar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;但朱子的移文补传并不是毫无道理的，这是基于唐中后期经学僵化、儒家心性理论薄弱而提出的对儒学的重建，是对当时被佛学思想深入的儒学进行清理与重整。有学者认为，”阐发经学中的‘义理’符合当时的社会现实向儒家提出的要求，也是儒家解经学依照自身逻辑发展的必然结果“。&lt;/p&gt;

&lt;p&gt;《礼记·大学》本来就条理比较清晰，能自成体系。朱子通过移文补传，使得本来就条理清晰的《大学》变得更加严谨，从而形成了较为完整的理论体系。中国古代的学说理论一般是”潜隐型“的体系，如《论语》以孔子言行载道，《庄子》借寓言辨理，而朱子修《大学》补传，在理学发展上可以说是一个创举，奠定了心理学的理论基础。&lt;/p&gt;

&lt;p&gt;朱子移文补传赋予了《大学》”修德“的新含义，是思想上的一次再创造。或者说《四书·大学》是《礼记·大学》在新的历史背景下作出的转型与发展。&lt;/p&gt;

&lt;p&gt;2017.05.11 于珠海&lt;/p&gt;

&lt;p&gt;文章同步发于&lt;a href=&quot;http://www.jianshu.com/p/701d5cd24d8f&quot;&gt;简书 - 为政之学与入徳之门？ - 酸的柠萌&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 12 May 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/05/12/post01/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/05/12/post01/</guid>
        
        <category>读书</category>
        
        <category>议论</category>
        
        <category>文艺</category>
        
        
      </item>
    
  </channel>
</rss>
